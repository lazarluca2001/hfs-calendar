<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>HFS Tour 2026 - Debug</title>
    <style>
        body { font-family: sans-serif; margin: 20px; }
        .grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 1px; background: #ccc; }
        .cell { background: white; min-height: 100px; padding: 5px; border: 1px solid #eee; }
        .header { background: #800000; color: white; padding: 10px; text-align: center; font-weight: bold; }
        .event { background: #ffebeb; padding: 4px; margin-top: 5px; border-left: 3px solid #800000; font-size: 12px; }
    </style>
</head>
<body>
    <h1>HFS | European Tour 2026</h1>
    <div id="status" style="padding: 10px; background: #eef; margin-bottom: 10px;">Kapcsolódás a Google Scripthez...</div>
    
    <div class="grid" id="calendar"></div>

    <script>
        const url = 'https://script.google.com/macros/s/AKfycbx9e75CADNirX7MZW1UhFyu7Pv2bqIOsIMTregdmvZE5KXi1aqLyuzuJ2iFyDri0SjO/exec';

        async function load() {
            const status = document.getElementById('status');
            try {
                const res = await fetch(url);
                const data = await res.json();
                
                if (data && data.length > 0) {
                    status.style.background = '#dfd';
                    status.innerText = 'Siker! ' + data.length + ' sor beolvasva a táblázatból.';
                    draw(data);
                } else {
                    status.innerText = 'Az adatok megérkeztek, de üres a lista. Ellenőrizd a táblázatot!';
                }
            } catch (err) {
                status.style.background = '#fdd';
                status.innerText = 'Hiba a betöltéskor! Ellenőrizd a Google Script "Anyone" beállítását.';
                console.error(err);
            }
        }

        function draw(events) {
            const cal = document.getElementById('calendar');
            const weekdays = ["Hé", "Ke", "Sze", "Csü", "Pé", "Szo", "Vas"];
            weekdays.forEach(d => cal.innerHTML += `<div class="header">${d}</div>`);

            // Példaként februárt mutatjuk (2026)
            const daysInMonth = 28;
            const startOffset = 6; // Feb 1 vasárnap (2026-ban) -> 6 üres hely

            for (let i = 0; i < startOffset; i++) cal.innerHTML += `<div class="cell" style="background:#f9f9f9"></div>`;

            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `2026. 02. ${day < 10 ? '0' + day : day}.`; // Figyelem a formátumra!
                
                // Megnézzük van-e esemény erre a napra
                const match = events.filter(e => {
                    const s = String(e["Start date"] || "");
                    const end = String(e["End date"] || "");
                    return dateStr >= s && dateStr <= end;
                });

                let html = `<div class="cell"><b>${day}</b>`;
                match.forEach(m => {
                    html += `<div class="event">${m.Event}</div>`;
                });
                cal.innerHTML += html + `</div>`;
            }
        }

        load();
    </script>
</body>
</html>
