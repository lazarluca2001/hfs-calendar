<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HFS European Tour 2026</title>
    <style>
        :root { --hfs-red: #800000; --status-igen: #4CAF50; --status-talan: #FF9800; --status-fizetve: #2196F3; --status-igazolt: #9C27B0; }
        body { font-family: 'Segoe UI', sans-serif; margin: 20px; background: #f4f4f4; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { color: var(--hfs-red); text-align: center; border-bottom: 2px solid var(--hfs-red); padding-bottom: 10px; margin-bottom: 15px; }
        
        /* H칩napv치laszt칩 st칤lusa */
        .controls { margin-bottom: 20px; text-align: center; }
        select { padding: 10px 20px; font-size: 16px; border: 2px solid var(--hfs-red); border-radius: 8px; cursor: pointer; background: white; font-weight: bold; color: var(--hfs-red); }
        
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 1px; background: #ddd; border: 1px solid #ddd; }
        .weekday { background: var(--hfs-red); color: white; padding: 10px; text-align: center; font-weight: bold; }
        .day { background: white; min-height: 150px; padding: 10px; position: relative; }
        .day-number { font-weight: bold; color: #555; display: block; margin-bottom: 5px; }
        .empty { background: #f9f9f9; }
        
        .event-card { border-left: 4px solid var(--hfs-red); padding: 5px; margin: 5px 0; background: #fffcfc; font-size: 0.82em; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-radius: 3px; }
        .event-name { font-weight: bold; color: #333; display: block; margin-bottom: 4px; }
        .person-tag { display: flex; align-items: center; gap: 5px; padding: 2px 5px; margin-top: 2px; border-radius: 3px; font-size: 0.85em; font-weight: 500; }
        
        .status-igen { background: #e8f5e9; color: #2e7d32; border-left: 3px solid var(--status-igen); }
        .status-talan { background: #fff8e1; color: #e65100; border-left: 3px solid var(--status-talan); }
        .status-fizetve { background: #e3f2fd; color: #0d47a1; border-left: 3px solid var(--status-fizetve); }
        .status-igazolt { background: #f3e5f5; color: #4a148c; border-left: 3px solid var(--status-igazolt); }
        
        .loader { text-align: center; font-style: italic; color: #666; padding: 20px; }
    </style>
</head>
<body>

<div class="container">
    <h1>HFS | European Tour 2026</h1>
    
    <div class="controls">
        <select id="monthSelect"></select>
    </div>

    <div id="loader" class="loader">Napt치r szinkroniz치l치sa...</div>
    <div id="calendar" class="calendar-grid"></div>
</div>

<script>
    const url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSDDBNbIkZize7hPMfYPovbLgnIFWNuseLg0mjzDYGhLCwEEiF_-CiXnV76lgg2mvb54QabZ8y3Sork/pub?gid=338581218&single=true&output=csv';

    const resztvevokMap = {
        "Csongi": { nev: "Ferenczi Csongor", emoji: "游깯" },
        "Merci": { nev: "Angyal Merc칠desz", emoji: "游눆" },
        "M칩zes": { nev: "Bende M치rton", emoji: "游붃" },
        "Luca": { nev: "L치z치r Luca", emoji: "游냤" },
        "Zoli": { nev: "Dominguez Zolt치n", emoji: "游돜" }
    };

    const months = ["Janu치r", "Febru치r", "M치rcius", "츼prilis", "M치jus", "J칰nius", "J칰lius", "Augusztus", "Szeptember", "Okt칩ber", "November", "December"];
    let allEvents = [];

    async function init() {
        try {
            const response = await fetch(url);
            const csvText = await response.text();
            const rows = csvText.split('\n').map(row => row.split(',').map(c => c.trim().replace(/"/g, '')));
            
            const headers = rows[3];
            allEvents = [];

            for(let i = 4; i < rows.length; i++) {
                let obj = {};
                rows[i].forEach((val, idx) => { obj[headers[idx]] = val; });
                if(obj.Event) allEvents.push(obj);
            }
            
            document.getElementById('loader').style.display = 'none';
            setupMonthSelect();
            render(new Date().getMonth()); // Az aktu치lis h칩nappal ind칤t
        } catch (e) { 
            document.getElementById('loader').innerText = "Hiba az adatok beolvas치sakor.";
        }
    }

    function setupMonthSelect() {
        const sel = document.getElementById('monthSelect');
        const currentMonth = new Date().getMonth();
        
        months.forEach((m, i) => {
            const opt = document.createElement('option');
            opt.value = i;
            opt.textContent = m;
            if(i === currentMonth) opt.selected = true;
            sel.appendChild(opt);
        });
        
        sel.onchange = (e) => render(parseInt(e.target.value));
    }

    function parseSheetDate(dStr) {
        if(!dStr || dStr.length < 8) return null;
        const p = dStr.replace(/\s/g, '').split('.');
        return new Date(p[0], p[1]-1, p[2]);
    }

    function render(monthIndex) {
        const cal = document.getElementById('calendar');
        cal.innerHTML = '';
        ["H칠tf콈", "Kedd", "Szerda", "Cs칲t칬rt칬k", "P칠ntek", "Szombat", "Vas치rnap"].forEach(d => cal.innerHTML += `<div class="weekday">${d}</div>`);

        const year = 2026;
        const firstDay = (new Date(year, monthIndex, 1).getDay() + 6) % 7;
        const daysInMonth = new Date(year, monthIndex + 1, 0).getDate();

        // 칖res napok a h칩nap elej칠n
        for(let i=0; i<firstDay; i++) cal.innerHTML += `<div class="day empty"></div>`;

        for(let d=1; d<=daysInMonth; d++) {
            const current = new Date(year, monthIndex, d);
            current.setHours(0,0,0,0);

            const daily = allEvents.filter(e => {
                const start = parseSheetDate(e["Start date"]);
                const end = parseSheetDate(e["End date"]);
                if(!start || !end) return false;
                return current >= start && current <= end;
            });

            let html = `<div class="day"><span class="day-number">${d}</span>`;
            daily.forEach(e => {
                let tagsHtml = "";
                Object.keys(resztvevokMap).forEach(k => {
                    const s = e[k]?.toLowerCase() || "";
                    if(["igen", "tal치n", "talan", "fizetve", "igazolt"].includes(s)) {
                        const info = resztvevokMap[k];
                        const cls = s.includes("talan") ? "status-talan" : `status-${s}`;
                        tagsHtml += `<div class="person-tag ${cls}">${info.emoji} ${info.nev}</div>`;
                    }
                });
                html += `<div class="event-card"><span class="event-name">${e.Event}</span>${tagsHtml}</div>`;
            });
            cal.innerHTML += html + `</div>`;
        }
    }
    init();
</script>
</body>
</html>
